

---

**CodeGuardian Edu - UI/UX 设计方案**

**版本:** **1.2 (修订版)**
**日期:** 2024年7月21日
**设计师:** [你的名字]
**修订说明:** v1.2 在 v1.1 的基础上，根据开发团队的反馈进行了全面澄清和补充。主要修订内容包括：

- **明确了注册流程中的密码强度指示器逻辑 (A1)。**
    
- **确定了仪表盘最近扫描的显示数量 (A2)。**
    
- **定义了压缩包内混合文件类型的处理逻辑 (A3)。**
    
- **提供了风险评分的具体计算公式 (A4)。**
    
- **增加了共享报告的隐私选项 (A5)。**
    
- **明确了规则集列表的数据来源和结构 (A6)。**
    
- **新增了“设计与开发资产”章节，提供了图标库、插画描述和骨架屏设计等具体资产清单 (B1-B4)。**
    
- **正式采纳了关于代码高亮库和字体加载策略的技术建议 (C1, C2)。**

---

### **1. 设计哲学与核心原则**

*   **引导而非说教 (Guiding, not Lecturing):** 界面应像一位友好的助教，引导学生发现问题、理解问题、解决问题，而不是像一台冰冷的机器扔出错误报告。
*   **清晰聚焦 (Clarity & Focus):** 避免信息过载。在每一步都只呈现当前任务所需的核心信息，通过“渐进式披露”引导用户深入。
*   **鼓励与成就感 (Encouragement & Accomplishment):** 使用积极的语言和视觉元素。即使发现了漏洞，也要强调这是一个学习和进步的机会。扫描成功或修复漏洞后应给予积极反馈。
*   **现代与专业 (Modern & Professional):** 视觉风格应现代、干净，同时传达出作为一款安全工具的专业性和可信赖感。

---

### **2. 信息架构与导航**

我们将采用一个简洁的、持久化的**左侧垂直导航栏**，以适应未来功能的扩展。

*   **导航结构 (登录后):**
    *   **Dashboard (仪表盘):** `icon-dashboard` - 欢迎页，提供快速开始扫描的入口和最近扫描历史的概览。
    *   **New Scan (开始扫描):** `icon-plus-circle` - 核心扫描流程的入口。
    *   **My Reports (我的报告):** `icon-file-text` - 历史扫描报告列表。
    *   --- (分隔线，仅教师可见) ---
    *   **Rule Sets (规则集管理):** `icon-sliders` - (教师专属) 管理自定义规则集。
    *   --- (页面底部) ---
    *   **User Profile (个人账户):** `icon-user` - 包含用户名和退出登录选项。

---

### **3. 视觉规范 (Visual Specification)**

*   **色彩体系 (Color Palette):**
    *   **主色 (Primary):** `#4A90E2` (一种沉稳而友好的蓝色) - 用于按钮、链接、高亮和关键操作。
    *   **背景色 (Background):** `#F8F9FA` (非常浅的灰色) - 避免纯白刺眼，营造柔和的视觉环境。
    *   **卡片/容器背景 (Container BG):** `#FFFFFF` (纯白) - 与背景色形成对比，突出内容区域。
    *   **文本颜色 (Text):**
        *   标题: `#1D2129` (深灰黑)
        *   正文: `#495057` (中度灰)
        *   辅助/次要信息: `#868E96` (浅灰)
    *   **语义色 (Semantic Colors):**
        *   **高危 (High):** `#E74C3C` (红色)
        *   **中危 (Medium):** `#F39C12` (橙色)
        *   **低危 (Low):** `#3498DB` (蓝色)
        *   **信息 (Info):** `#95A5A6` (灰色)
        *   **成功 (Success):** `#2ECC71` (绿色)

*   **字体 (Typography):**
    *   **主字体:** `Inter` (一款开源、清晰的无衬线字体，可读性极佳)。
    *   **代码字体:** `Fira Code` 或 `JetBrains Mono` (支持连字，美观且专业)。
    *   **字号层级:**
        *   H1 (页面主标题): `28px` Bold
        *   H2 (区域标题): `22px` SemiBold
        *   H3 (卡片标题): `18px` SemiBold
        *   Body (正文): `16px` Regular
        *   Small (辅助文本): `14px` Regular

*   **间距与圆角 (Spacing & Radius):**
    *   **基础间距单位:** `8px`。所有外边距(margin)和内边距(padding)都应是 `8px` 的倍数 (e.g., 8, 16, 24, 32px)。
    *   **圆角:**
        *   按钮/输入框: `6px`
        *   卡片/容器: `12px`

---

### **4. 关键页面与组件设计 (Key Pages & Component Design)**

#### **4.1 登录与注册流程**

*   **登录页:**
    *   **布局:** 居中卡片式布局。
    *   **组件:**
        *   Logo: `CodeGuardian Edu`
        *   标题: `欢迎回来`
        *   输入框: 邮箱/用户名 (带 `icon-mail`)
	    *   输入框: `密码` (带密码强度指示器):
	        *   视觉表现: 在密码输入框下方，显示一个由四段组成的条形指示器和一段描述性文字。
	        *   强度等级与逻辑:
	            *   太弱 (Too Weak): 1/4 条亮起，颜色为高危红色 (`#E74C3C`)。文字提示: `太弱`。
	                *   *标准:* 密码长度少于8位。
	            *   中等 (Medium): 2/4 条亮起，颜色为中危橙色 (`#F39C12`)。文字提示: `中等`。
	                *   *标准:* 长度至少8位，且包含大小写字母和数字中的任意两种。
	            *   强 (Strong): 4/4 条亮起，颜色为成功绿色 (`#2ECC71`)。文字提示: `强`。
	                *   *标准:* 长度至少8位，且同时包含大小写字母、数字和特殊字符。
	        *   交互: 当用户开始输入时，指示器实时更新。
        *   按钮: `登录` (主色填充按钮)
        *   链接: `忘记密码?` | `没有账户? 注册`
*   **注册页:**
    *   **布局:** 与登录页一致的居中卡片式布局。
    *   **组件:**
        *   标题: `创建您的 CodeGuardian 账户`
        *   输入框: `姓名` (e.g., Alex)
        *   输入框: `邮箱`
        *   输入框: `密码` (带密码强度指示器)
        *   输入框: `确认密码`
        *   **单选框组:** `您的角色是:`
            *   `[●] 学生`
            *   `[○] 教师`
        *   复选框: `我同意服务条款和隐私政策。` (链接)
        *   按钮: `注册` (主色填充按钮)
        *   链接: `已经有账户了? 登录`
    *   **内联验证:** 所有输入框在失去焦点时进行验证，错误信息（e.g., `请输入有效的邮箱地址`, `两次输入的密码不一致`）显示在输入框下方，颜色为高危红色 (`#E74C3C`)。

#### **4.2 仪表盘 (Dashboard Page)**

*   **布局:** 两列式布局。
*   **左侧 (主区域):**
    *   **欢迎卡片:**
        *   标题 (H1): `你好, Alex!`
        *   描述: `准备好让你的代码更安全了吗？`
        *   **CTA按钮:** `开始新的扫描` (主色大按钮，带 `icon-play` 图标) -> 跳转至 New Scan 页面。
*   **右侧 (次区域) / 或主区域下方:**
    *   **最近扫描卡片:**
        *   标题 (H2): `最近的扫描`
        *   列表: 显示最近 5 次的扫描记录。
        *   **列表项组件:**
            *   文件名/项目名 (e.g., `assignment5.zip`)
            *   扫描时间 (e.g., `2小时前`)
            *   风险评分/结果摘要 (e.g., `高危: 1, 中危: 3`) - 用语义色小标签展示。
            *   操作: `查看报告` 链接。
*   **空状态 (Empty State):** 如果是新注册用户，没有任何扫描历史，右侧/下方区域将显示一个友好的插画（例如一个干净的代码文件和一个微笑的盾牌），并配文：
    *   标题: `欢迎来到 CodeGuardian!`
    *   正文: `你还没有进行任何扫描。点击“开始新的扫描”来检查你的第一个项目吧！`

#### **4.3 开始扫描页面 (New Scan Page - FR-01)**

这是一个三步向导式界面。

*   **Step 1: 上传代码**
    *   标题 (H2): `上传你的代码`
    *   **文件上传组件:**
        *   一个大的虚线框区域，支持**拖拽上传**和**点击选择文件**。
        *   提示文字: `拖拽 .c, .cpp, .h 文件或一个 .zip 包到这里`。
        *   文件大小限制提示 (e.g., `最大 10MB`)。
        *   上传后，显示文件列表，用户可移除文件。
    *   **错误处理:**
        *   **文件类型错误:** 如果用户上传了不支持的文件类型（如 `.docx`），该文件在列表中会以红色高亮显示，并附带一个错误图标和提示文字：`文件类型不支持`。`下一步` 按钮将变为禁用状态。
        *   **文件大小错误:** 如果文件超过 10MB 限制，同样显示错误提示：`文件超过 10MB 上限`。
        *   **压缩包内混合文件类型:** 如果用户上传的 .zip 包中包含不支持的文件类型（如 .jpg），后端应**忽略这些不支持的文件**，仅扫描支持的文件。在文件上传成功后，应在文件列表下方显示一条**非阻塞的警告信息**：提示：压缩包中的 [N] 个非代码文件 (如 .jpg, .docx) 已被忽略。 下一步按钮仍然可用。
    *   按钮: `下一步` (上传文件后才可点击)。

*   **Step 2: 选择扫描模式**
    *   标题 (H2): `选择扫描模式`
    *   **模式选择卡片 (Radio Buttons):**
        *   **[卡片1] 快速检查:**
            *   标题: `🚀 快速检查`
            *   描述: `专注于最常见和高风险的漏洞，通常在1分钟内完成。`
        *   **[卡片2] 全面扫描:**
            *   标题: `🔍 全面扫描`
            *   描述: `进行更深入的分析，可能需要几分钟时间。`
        *   **[卡片3] 教学模式 (若教师定义了规则集):**
            *   标题: `👨‍🏫 教学模式`
            *   描述: `使用你的老师指定的规则集进行检查。`
            *   下拉菜单: (如果教师创建了多个) `选择规则集: [作业5-字符串安全]`
    *   按钮: `上一步` | `开始扫描`。

*   **Step 3: 扫描中...**
    *   这是一个过渡页面。
    *   **布局:** 居中。
    *   **动画:** 一个自定义的 Lottie 动画 (例如一个盾牌正在扫描代码波纹)。
    *   **文本:** `正在分析您的代码...`
    *   **进度指示器:** 一个细长的进度条，模拟进度（可以是伪进度，从0%缓慢增加到90%，扫描结束后跳到100%），以缓解用户焦虑。

#### **4.4 扫描报告页 (Scan Report Page - FR-02, FR-03, FR-06)**

这是产品的核心页面，采用“顶部摘要 + 下方详情”的布局。

*   **页面顶部:**
    *   **报告头:**
        *   标题 (H1): `assignment5.zip 的安全报告`
        *   元信息: `扫描于: 2024-07-20 14:30` | `模式: 快速检查`
    *   **分享按钮 (FR-06):**
        *   一个 `分享` 按钮 (带 `icon-share`)。
        *   **交互:** 点击后，弹出一个小的 Popover/Modal，内容为：
            *   标题: `分享报告`
            *   文本: `任何人都可以通过此链接查看这份只读报告。`
            *   输入框 (只读): `https://codeguardian.edu/report/unique-hash-string`
            *   按钮: `复制链接` (点击后显示 "已复制!" 的提示)。
            *   新增复选框: [✓] 在报告中显示我的姓名 (Alex)。此选项默认勾选。如果用户取消勾选，共享报告页面将不会显示其姓名。
*   **摘要视图 (Summary View - FR-02):**
    *   **布局:** 一行三个关键指标卡片。
    *   **[卡片1] 总体风险评分:**
        *   大号数字: `43` 
        *   标题: `风险评分`
        *   描述: `分数越高，风险越大。`
    *   **[卡片2] 发现的问题:**
        *   大号数字: `5`
        *   标题: `问题总数`
    *   **[卡片3] 问题分布图:**
        *   一个**甜甜圈图 (Donut Chart)** 或 **水平条形图**。
        *   图例: `高危: 1`, `中危: 3`, `低危: 1`，颜色对应语义色。
*   **问题列表视图 (Issue List View - FR-02):**
    *   **布局:** 位于摘要视图下方的一个表格或卡片列表。
    *   **表格列头:** `严重性` | `漏洞类型 (CWE)` | `位置`
    *   **表格行/列表项 (可点击):**
        *   **严重性:** 用一个带颜色的胶囊标签 (Pill/Tag) 表示 (e.g., `<span class="tag-high">High</span>`)。
        *   **漏洞类型:** `缓冲区溢出 (CWE-120)`
        *   **位置:** `src/utils.cpp: Line 42`
        *   **交互:** 整行可点击，鼠标悬停时有背景高亮效果。
*   **详细问题视图 (Detailed Issue View - FR-03):**
    *   **交互:** 点击问题列表中的一项后，**在列表下方展开一个详情区域 (Accordion/Expandable Panel)**，而不是跳转页面，以保持上下文。
    *   **布局 (展开区域内):**
        *   **左侧: 代码浏览器**
            *   显示漏洞所在文件的代码片段。
            *   **高亮:** 漏洞行用醒目的背景色（例如淡红色）高亮。
            *   **行号:** 显示行号。
        *   **右侧: 教育内容 (FR-03 JSON内容的呈现)**
            *   标题 (H3): `缓冲区溢出 (CWE-120)`
            *   **区域1: 通俗解释**
                *   小标题: `🤔 这是什么意思?`
                *   内容: 来自PRD的 `plain_explanation`。
            *   **区域2: 危害场景**
                *   小标题: `💥 为何是个问题?`
                *   内容: 来自PRD的 `why_is_it_a_problem`。
            *   **区域3: 如何修复**
                *   小标题: `🔧 如何修复?`
                *   描述: 来自PRD的 `how_to_fix.description`。
                *   **代码对比组件:**
                    *   并排或上下排列两个代码块。
                    *   左/上标题: `❌ 错误代码` (内容: `bad_code`)
                    *   右/下标题: `✅ 正确代码` (内容: `good_code`)
            *   **区域4: 了解更多**
                *   小标题: `📚 深入学习`
                *   链接列表: 渲染 `learn_more_links`。
*   **空状态:** 如果一次扫描成功完成但未发现任何问题：
    *   摘要视图的图表将被一个大的绿色对勾图标 `✅` 和祝贺信息取代。
    *   标题 (H2): `太棒了！`
    *   正文: `我们没有在您的代码中发现任何已知的安全问题。请继续保持良好的编码习惯！`
    *   问题列表区域将隐藏。

#### **4.5 规则集管理页 (Rule Set Management Page - FR-04, 教师专属)**

*   **布局:** 页面分为左右两部分。左侧是规则集列表，右侧是选定规则集的编辑区。
*   **左侧: 规则集列表**
    *   标题 (H2): `我的规则集`
    *   按钮: `+ 新建规则集`
    *   列表:
        *   默认规则集 (不可编辑，e.g., `标准检查`, `严格检查`)
        *   自定义规则集 (e.g., `作业5-字符串安全`)，旁边有 `编辑` 和 `删除` 图标。
*   **右侧: 编辑区**
    *   标题 (H3): `编辑: 作业5-字符串安全`
    *   输入框: `规则集名称`
    *   输入框: `描述 (可选)`
    *   **规则列表 (可折叠的分类):**
        *   **分类标题 (可折叠):** `▼ 内存管理漏洞`
            *   **规则项:** `[Toggle Switch] 缓冲区溢出 (CWE-120)`
            *   **规则项:** `[Toggle Switch] 内存泄漏 (CWE-401)`
        *   **分类标题:** `▼ 不安全的函数使用`
            *   ...
    *   **操作按钮:** `保存更改` | `取消`
*   **空状态:** 如果教师用户还未创建任何自定义规则集，右侧编辑区将显示：
    *   插画: (例如一支笔和一张纸)
    *   标题: `管理您的教学规则`
    *   正文: `点击左侧的“+ 新建规则集”来创建您的第一个自定义规则，以匹配您的课程教学目标。`
*   **删除确认模态框 (Confirmation Modal):**
    *   **触发:** 点击规则集旁边的 `删除` 图标。
    *   **布局:** 居中模态框，带蒙层背景。
    *   **标题:** `确认删除`
    *   **内容:** `您确定要删除规则集 “[规则集名称]” 吗？此操作无法撤销。`
    *   **按钮:**
        *   `取消` (次要按钮，灰色边框)
        *   `确认删除` (主要危险操作按钮，红色填充)

#### **4.6 共享报告视图 (Shared Report View)**

*   **用途:** 当任何人通过唯一URL访问共享报告时看到的页面。
*   **布局:** 极简布局，移除了主应用的导航和个人信息。
*   **页面结构:**
    *   **顶部栏:**
        *   左侧: `CodeGuardian Edu` Logo。
        *   右侧: 
			- 如果用户分享时勾选了“显示姓名”：显示 “一份由 Alex 分享的安全报告”。
			- 如果用户取消勾选：显示 “一份来自 CodeGuardian Edu 的安全报告”。
    *   **主体内容:** 完全复用 **4.4 扫描报告页** 的内容（摘要、列表、详情），但所有操作（如再次扫描、分享）均被移除。页面完全**只读**。

---

### **5. 状态、错误与边缘情况设计 (States, Errors, and Edge Cases)**

本节集中定义了全局的异常状态，以确保体验的一致性。

*   **5.1 全局加载状态:**
    *   **页面切换:** 使用顶部细线形进度条 (Top-loading bar) 来指示页面跳转加载。
    *   **数据获取:** 关键内容区域（如报告列表、规则集列表）在加载数据时应显示**骨架屏 (Skeleton Screens)**，其形状与最终内容布局相似。
    * **5.1.1 骨架屏设计 (新增):**
	    - **我的报告 (列表页):** 在加载时，显示 3-4 个矩形卡片骨架。每个卡片骨架包含左侧一个灰色小方块（模拟风险标签），和右侧两行不同长度的灰色条（模拟文件名和时间）。
	    - **扫描报告 (详情页):**
	        - **摘要区域:** 显示三个并排的矩形骨架，每个骨架内有一个圆形（模拟图表）或几行短条（模拟数字和标题）。
	        - **问题列表区域:** 显示一个表格骨架，包含 4-5 行，每行有三列不同宽度的灰色长条。

*   **5.2 全局错误状态: 扫描失败**
    *   **场景:** 后端分析引擎崩溃或因其他原因导致扫描任务失败。
    *   **呈现:** 用户将被引导至一个专用的错误状态页面。
    *   **设计:**
        *   一个表示错误的插画 (例如一个破碎的盾牌)。
        *   标题 (H1): `扫描失败`
        *   正文: `抱歉，我们在分析您的代码时遇到了一个意外问题。请检查您的代码是否可以正常编译，然后重试。如果问题仍然存在，请联系我们的支持。`
        *   **CTA按钮:** `返回仪表盘` | `重新扫描`

*   **5.3 404 Not Found 页面**
    *   **设计:** 友好的404页面，包含插画、标题 `页面未找到` 和一个返回仪表盘的按钮。

*   **5.4 无权限访问页面**
    *   **场景:** 学生尝试访问教师专属的 `/rulesets` 页面。
    *   **设计:** 显示一个简洁的页面，标题为 `访问被拒绝`，内容为 `您没有权限访问此页面。`，并提供返回仪表盘的链接。

---

### **6. 核心 UX Writing 与术语表**

为保证文案的一致性，定义核心术语和常用文案。

| 术语/场景            | 英文术语 (参考)  | 确定文案                                     | 备注                               |
| -------------------- | ---------------- | -------------------------------------------- | ---------------------------------- |
| 核心操作             | Scan             | 扫描                                         | 避免使用“分析”、“检查”等词语       |
| 发现的问题           | Issue / Finding  | 问题 / 发现的问题                            | 避免使用过于专业或吓人的“漏洞”     |
| 规则集               | Rule Set         | 规则集                                       |                                    |
| **按钮文案**         |                  |                                              |                                    |
| 开始扫描流程         | Start Scan       | 开始新的扫描                                 |                                    |
| 确认删除             | Confirm Delete   | 确认删除                                     | 用于危险操作的确认按钮             |
| 保存更改             | Save Changes     | 保存更改                                     |                                    |
| **Toast 通知**       |                  |                                              |                                    |
| 链接复制成功         | Link Copied      | `✅ 链接已成功复制到剪贴板！`               | 持续 3 秒后自动消失                |
| 保存成功             | Saved            | `✅ 规则集已保存。`                          |                                    |
| **错误信息**         |                  |                                              |                                    |
| 通用后端错误         | Server Error     | `操作失败，请稍后重试或联系支持。`           |                                    |

---

### **7. 可访问性 (Accessibility, A11y) 指南**

产品必须对所有用户可用，包括使用辅助技术的用户。

*   **标准:** 所有开发应力求符合 **WCAG 2.1 AA** 标准。
*   **颜色对比度:** 所有文本与背景的对比度必须至少为 `4.5:1`。使用在线工具进行检查。
*   **键盘导航:**
    *   所有交互元素（链接、按钮、输入框）必须可以通过 `Tab` 键访问。
    *   `Tab` 键的焦点顺序必须符合逻辑，与视觉流一致。
    *   焦点状态必须有清晰的视觉指示（例如，醒目的外边框 `outline`）。
*   **语义化 HTML:** 使用正确的 HTML5 标签（`<nav>`, `<main>`, `<button>` 等）来定义页面结构和元素功能。
*   **图像与图标:**
    *   所有非装饰性图像必须有描述性的 `alt` 文本。
    *   所有仅有图标的按钮必须提供 `aria-label` 属性来描述其功能 (e.g., `<button aria-label="删除规则集"><IconDelete /></button>`)。

---

### **8. 交互与动效 (Interaction & Animation)**

*   **页面过渡:** 使用轻微的淡入淡出效果 (`fade-in/fade-out`)。
*   **按钮交互:** 悬停时轻微放大 (`scale: 1.05`) 或颜色变亮。
*   **加载状态:** 在数据加载区域（如图表、列表）使用骨架屏 (Skeleton Screen) 或微调的加载动画 (Spinner)。
*   **通知/提示:** 使用右上角的 Toast 组件来显示操作结果，如“链接已复制”、“规则集已保存”。
*   **代码浏览器/对比组件实现:** 同意并推荐使用成熟的第三方库来实现代码高亮和差异对比功能。推荐Prism.js 或 highlight.js 用于语法高亮，react-diff-viewer (或类似库) 用于代码差异对比。确保所选库的主题颜色与我们的视觉规范保持一致。

---

### **9. 设计与开发资产**

本章节汇总了开发过程中所需的具体设计资产。

*   **9.1 图标库 (Icon Set):**
    *   **库:** 我们将使用 **Feather Icons** ([https://feathericons.com/](https://feathericons.com/))。它风格简洁现代，与我们的设计哲学相符。
    *   **图标映射:**
        *   `icon-dashboard` -> `layout`
        *   `icon-plus-circle` -> `plus-circle`
        *   `icon-file-text` -> `file-text`
        *   `icon-sliders` -> `sliders`
        *   `icon-user` -> `user`
        *   `icon-mail` -> `mail`
        *   `icon-lock` -> `lock`
        *   `icon-play` -> `play-circle`
        *   `icon-share` -> `share-2`
    *   **交付:** 开发可直接通过 NPM 安装 `feather-icons` 或使用其 SVG 文件。

*   **9.2 插画 (Illustrations):**
    *   **风格:** 采用简洁、友好的扁平化插画风格，主色调与产品色板保持一致。
    *   **具体描述:**
        *   **仪表盘空状态:** 一个代码编辑器窗口的轮廓，旁边有一个微笑、自信的盾牌 `🛡️` 图标，周围有几颗小星星 `✨` 表示“干净、安全”。
        *   **规则集管理空状态:** 一支钢笔正在一张清单上打勾 `✓`，清单代表规则集。
        *   **扫描失败状态:** 一个略带悲伤表情的破碎盾牌 `💔`，旁边有一个警示三角 `⚠️`。
        *   **404 页面:** 一个宇航员漂浮在太空中，面前是一个“404”星球，表示迷失了方向。
    *   **交付:** 设计团队将提供上述场景的 SVG 格式插画文件。

*   **9.3 扫描中动画 (Animation):**
    *   **交付:** 设计团队将提供一个 Lottie 动画的 `.json` 文件。动画内容为一个盾牌从左到右扫描过一连串代码符号（`{ }`, `</>`, `=>`）。

*   **9.4 字体文件与加载策略:**
    *   **采纳建议:** 同意将 `Inter` 和 `Fira Code` 字体文件进行本地化托管，以优化性能。
    *   **CSS 实现:** 在 `@font-face` 规则中使用 `font-display: swap;` 策略，确保快速内容呈现。
    *   **交付:** 将提供所需的 `woff2` 格式字体文件。

---
**设计方案结束**


